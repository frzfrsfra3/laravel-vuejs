<template>
    <div class="container">
        <!-- {{--  <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">Users Component</div>

                    <div class="card-body">
                        I'm an example component.
                    </div>
                </div>
            </div>
        </div> --}} -->
        <div
            class="product-small col has-hover product type-product post-19967 status-publish first instock product_cat-apple product_tag-tablets has-post-thumbnail shipping-taxable purchasable product-type-variable wvs-pro-product wvs-pro-after-cart-button"
        >
            <div class="col-inner">
                <div class="badge-container absolute left top z-1"></div>
                <div class="product-small box ">
                    <div class="box-image">
                        <div class="image-fade_in_back">
                            <a
                                href="https://www.phonefinity.net/apple/ipad-pro-11-2021/"
                            >
                                <img
                                    src="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg"
                                    data-src="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg"
                                    class="attachment-woocommerce_thumbnail size-woocommerce_thumbnail wvs-attachment-image lazyloaded"
                                    alt="ipad pro 11 2021 silver 1 250x250 - Apple iPad Pro 11 (2021)"
                                    data-srcset="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg 250w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-500x500.jpg 500w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-125x125.jpg 125w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-768x768.jpg 768w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-100x100.jpg 100w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1.jpg 1000w"
                                    sizes="(max-width: 250px) 100vw, 250px"
                                    title="Apple iPad Pro 11 (2021)"
                                    srcset="
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg  250w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-500x500.jpg  500w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-125x125.jpg  125w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-768x768.jpg  768w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-100x100.jpg  100w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1.jpg         1000w
                                    "
                                    width="250"
                                    height="250"
                                /><noscript
                                    ><img
                                        width="250"
                                        height="250"
                                        src="data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%20250%20250%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3C%2Fsvg%3E"
                                        data-src="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg"
                                        class="lazy-load attachment-woocommerce_thumbnail size-woocommerce_thumbnail wvs-attachment-image lazyload"
                                        alt="ipad pro 11 2021 silver 1 250x250 - Apple iPad Pro 11 (2021)"
                                        srcset=""
                                        data-srcset="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-250x250.jpg 250w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-500x500.jpg 500w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-125x125.jpg 125w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-768x768.jpg 768w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1-100x100.jpg 100w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-silver-1.jpg 1000w"
                                        sizes="(max-width: 250px) 100vw, 250px"
                                        title="Apple iPad Pro 11 (2021)"/></noscript
                                ><img
                                    src="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-250x250.jpg"
                                    data-src="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-250x250.jpg"
                                    class="show-on-hover absolute fill hide-for-small back-image wvs-attachment-image lazy-load-active"
                                    alt="ipad pro 11 2021 space gray 1 250x250 - Apple iPad Pro 11 (2021)"
                                    srcset="
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-250x250.jpg  250w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-500x500.jpg  500w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-125x125.jpg  125w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-768x768.jpg  768w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-100x100.jpg  100w,
                                        https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1.jpg         1000w
                                    "
                                    data-srcset="https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-250x250.jpg 250w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-500x500.jpg 500w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-125x125.jpg 125w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-768x768.jpg 768w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1-100x100.jpg 100w, https://www.phonefinity.net/wp-content/uploads/ipad-pro-11-2021-space-gray-1.jpg 1000w"
                                    sizes="(max-width: 250px) 100vw, 250px"
                                    title="Apple iPad Pro 11 (2021)"
                                    width="250"
                                    height="250"
                                />
                            </a>
                        </div>
                        <div
                            class="image-tools is-small top right show-on-hover"
                        ></div>
                        <div
                            class="image-tools is-small hide-for-small bottom left show-on-hover"
                        ></div>
                        <!-- <div
                            class="image-tools grid-tools text-center hide-for-small bottom hover-slide-in show-on-hover"
                        >
                            <a
                                class="quick-view quick-view-added"
                                data-prod="19967"
                                href="#quick-view"
                                >Quick View</a
                            >
                        </div> -->
                    </div>
                    <div class="box-text box-text-products">
                        <div class="title-wrapper">
                            <p
                                class="category uppercase is-smaller no-text-overflow product-cat op-7"
                            >
                                Apple
                            </p>
                            <p
                                class="name product-title woocommerce-loop-product__title"
                            >
                                <a
                                    href="https://www.phonefinity.net/apple/ipad-pro-11-2021/"
                                    class="woocommerce-LoopProduct-link woocommerce-loop-product__link"
                                    >Apple iPad Pro 11 (2021)</a
                                >
                            </p>
                        </div>
                        <div class="price-wrapper">
                            <span class="price"
                                ><span class="woocommerce-Price-amount amount"
                                    ><bdi
                                        ><span
                                            class="woocommerce-Price-currencySymbol"
                                            >$</span
                                        >900</bdi
                                    ></span
                                >
                                â€“
                                <span class="woocommerce-Price-amount amount"
                                    ><bdi
                                        ><span
                                            class="woocommerce-Price-currencySymbol"
                                            >$</span
                                        >1,250</bdi
                                    ></span
                                ></span
                            >
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
export default {
    data() {
        return {
            editmode: false,
            users: {},
            form: new Form({
                id: "",
                name: "",
                email: "",
                password: "",
                type: "",
                bio: "",
                photo: ""
            })
        };
    },
    methods: {
        getProfilePhoto() {
            let photo =
                this.form.photo.length > 200
                    ? this.form.photo
                    : "img/profile/" + this.form.photo;
            return photo;
            // return "img/profile/"+ this.form.photo;
        },
        getResults(page = 1) {
            axios.get("api/user?page=" + page).then(response => {
                this.users = response.data;
            });
        },
        updateUser() {
            this.$Progress.start();
            console.log("editing Data");
            this.form
                .put("api/user/" + this.form.id)
                .then(() => {
                    $("#addNew").modal("hide");
                    Swal.fire(
                        "Updated!",
                        "Your file has been updated.",
                        "success"
                    );

                    this.$Progress.finish();
                    Fire.$emit("AfterCreate");
                })
                .catch(() => {
                    this.$Progress.fail();
                });
        },
        editModal(user) {
            this.editmode = true;
            this.form.reset();
            $("#addNew").modal("show");
            this.form.fill(user);
        },
        newModal() {
            this.editmode = false;
            this.form.reset();
            $("#addNew").modal("show");
        },

        deleteUser(id) {
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Yes, delete it!"
            }).then(result => {
                if (result.isConfirmed) {
                    // Send request to the server
                    this.form
                        .delete("api/user/" + id)
                        .then(() => {
                            Swal.fire(
                                "Deleted!",
                                "Your file has been deleted.",
                                "success"
                            );
                            Fire.$emit("AfterCreate");
                        })
                        .catch(() => {
                            Swal.fire(
                                "Failed !",
                                " There was something wrong. ",
                                "warning"
                            );
                        });
                }
            });
        },
        loadUsers() {
            // this.form.post('api/user');
            // axios.get("api/user").then(({data})=> (this.users = data));
            if (this.$gate.isAdminOrAuthor()) {
                axios.get("api/user").then(({ data }) => (this.users = data));
            }
        },
        createUser() {
            this.$Progress.start();
            this.form
                .post("api/user")
                .then(() => {
                    Fire.$emit("AfterCreate");
                    $("#addNew").modal("hide");

                    Toast.fire({
                        icon: "success",
                        title: " User created  in successfully"
                    });
                    this.$Progress.finish();
                })
                .catch(() => {});
        }
    },
    //   mounted() {
    //     console.log('Component mounted.')
    // }
    created() {
        this.loadUsers();
        Fire.$on("searching", () => {
            // let query="";
            let query = this.$parent.search;
            axios
                .get("api/findUser?q=" + query)
                .then(data => {
                    this.users = data.data;
                })
                .catch(() => {});
        });
        Fire.$on("AfterCreate", () => {
            this.loadUsers();
        });
        // setInterval(() => this.loadUsers(),3000);
    }
};
</script>
